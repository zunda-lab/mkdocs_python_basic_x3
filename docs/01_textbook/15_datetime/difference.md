# 日付の引き算をする方法を学ぼう

例えば10年以上離れた2つの日付があり、日付の差が何日かを知りたい。うるう年をはさむので、単純な計算で求めることはできない。自分が生まれた日から今日まで何日生きてきたかなどですね。

そんなとき皆さんならどうしますか。「先生、日付計算サイトがありまーす」はい。それも正解です。でも今回は自分の力で結果を出す方法を考えましょう。

こんな時はプログラムの出番。Pythonには日付の引き算をする機能があらかじめ用意されているんです。

どのような方法で日付の引き算をするのか、このレクチャーで学びましょう。

## 任意の日付を作成する

日付の引き算をするには、引き算対象の日付をデータして作成する必要があります。

このレクチャーではそんな任意の日付を作成する方法を紹介します。

まずは書式です。

```
datetime.date(西暦年, 月, 日)
```

書式は「datetime・ピリオド・date・丸カッコ・西暦年・カンマ・スペース・月・カンマ・スペース・日・丸カッコ閉じ」です。

階層構造を含めて言うと、datetimeモジュールのdateクラスを利用するということです。

「先生、クラスを利用するってどういうことですか？関数とかメソッドではないんですか？」

そうですよね。そう思いますよね。

前のレクチャーで、クラスはtoday関数のような関数が含まれるモノと紹介しました。実はこのクラス、丸カッコをつけて実行することができるんです。今回はdateクラス。dateクラスの丸カッコの中に、西暦年と月と日を指定して任意の日付を作成します。

では、dateクラスを使った簡単なプログラム例を紹介します。

```
import␣datetime

year_end␣=␣datetime.date(2021, 12, 31)
print(year_end)
```

```
2021-12-31
```

４行のプログラムです。

１行目には、import文を記載します。「import・スペース・datetime」です。これで標準ライブラリのdatetimeモジュールが使用可能となりました。

１行空けて３行目、dateクラスを使います。「year・アンダースコア・end・スペース・イコール・スペース・datetime・ピリオド・date・丸カッコ・2021・カンマ・スペース・12・カンマ・スペース・31・丸カッコ閉じ」ですね。これで2021年12月31日が作成できるので、イコールでyear_end変数に代入しています。

４行目はprint関数でyear_end変数を参照しています。つまりyear_end変数に保存された日付をディスプレイに表示するということです。

実行結果で2021年12月31日が表示されていますね。

ここで前のレクチャーと同じ質問をします。year_end変数はどんな型だと思いますか？日付を保存できるのは何型だったでしょうか？答えは「date型」。dateクラスもtoday関数と同様、日付を保存できる「date型」を返すんです。

## 日付の引き算をイメージする

このスライドでは皆さんに、日付の引き算をイメージしていただきます。

まずは、１つ目の日付として、2022年1月1日を保存したnew_yearという変数を用意します。

次に、２つ目の日付として2021年12月31日を保存したyear_endという変数を用意します。

このふたつの日付の引き算をするんです。1月1日と前の年の12月31日の差は1日ですね。

ちなみにこの2つの変数のデータ型は共にdate型です。

では、この引き算の結果を、tdという変数に代入しましょう。

td変数の中には2つの日付の差「1日」が保存されます。

さあ、このtd変数、型は何型だと思いますか。

「先生、わかりません！」そうですよね。そう思いますよね。答えは「timedelta型」。「timedelta型」は日付や時間の差を保持する型です。deltaという英単語には差分という意味もあるんです。時間の差分ということでtimedelta型なんですね。timedelta型の変数なので、変数名をtdと命名しました。

それから、このtimedelta型、時間の差として秒やミリ病も保存できます。今回の引き算の答えはちょっきり１日だったので、td変数に保存されるのは１日と０秒ということになります。何を言いたいのかというと、td変数を参照しただけでは１という数字を引き出すことはできないということです。

timedelta型の変数から日数だけを取得して違う変数に代入するプログラムを紹介します。

```
days␣=␣td.days
```

「days・スペース・イコール・スペース・td・ピリオド・days」。

このプログラムを書くと、timedelta型の変数のdays属性を参照して、日数だけをdays変数に代入するんです。

「先生、属性って何ですか？」そうですよね。そう思いますよね。属性とは、変数の中の変数のようなもので、変数にピリオドと属性名と書くことで参照できます。例えば唐揚げ弁当の中のポテトサラダのようなイメージです。

いかがでしょうか？日付の引き算がイメージできたでしょうか？

次のスライドではこのイメージをプログラムに落とし込んでいきます。

## 日付を引き算するプログラム例

それでは、前のスライドでイメージした日付の引き算をプログラミングしてみましょう。

```
01: import␣datetime
02: 
03: year_end␣=␣datetime.date(2021, 12, 31)
04: new_year␣=␣datetime.date(2022, 1, 1)
05: td␣=␣new_year␣-␣year_end
06: days␣=␣td.days
07: print(days)
```

```
1
```

このスライドのプログラム例は、説明しやすいように行の先頭に２桁で行番号を書きました。

１行目はインポート文を使ってdatetimeモジュールの使用を宣言しています。

インポートの後は、Pythonの慣習に従って、行をひとつ開けましょう。

３行目はdatetimeモジュールのdateクラスを使って、2021年、12月、31日の日付を作成してyear_end変数に代入しています。

４行目もdatetimeモジュールのdateクラスを使って、2022年、1月、1日の日付を作成してnew_year変数に代入しています。

５行目はnew_year変数からyear_end変数の引き算をして、td変数に代入しています。前のスライドで変数の箱を使って説明したイメージをプログラムとして書いています。本当に引き算で指定しているんです。びっくりですよね。

６行目では引き算の結果を代入したtd変数のdays属性を参照して、日数だけを取り出しdays変数に代入しています。

最後、７行目、print関数でdays変数をディスプレイに表示するというわけです。

実行結果には日付の差である「1」が表示されています。

どうでしょうか。Pythonの日付や時間の計算は、他のプログラミング言語と比較してすごく簡単にプログラムがかけるんです。先生も初めて触れたときには感動しましたよ。

以上「日付の引き算をする方法を学ぼう」でした。

